Функция ПолучитьСправочникПоРеквизиту(ИмяСпр,ИмяРеквизита,ЗначениеРеквизита)
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	__ИмяСпр__.Ссылка Как Ссылка
		|ИЗ
		|	Справочник.__ИмяСпр__ КАК __ИмяСпр__
		|ГДЕ
		|	__ИмяСпр__.__ИмяРеквизита__ = &ЗначениеРеквизита";
		
		
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"__ИмяСпр__",ИмяСпр);	
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"__ИмяРеквизита__",ИмяРеквизита);	
	Запрос.УстановитьПараметр("ЗначениеРеквизита", ЗначениеРеквизита);
	
	РезультатЗапроса = Запрос.Выполнить();
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Возврат ВыборкаДетальныеЗаписи.Ссылка;
	КонецЦикла;
	
	Возврат Справочники[ИмяСпр].ПустаяСсылка();
КонецФункции	

Функция ПолучитьДокументПоНомеру(ИмяДок,НомерДок,ДатаДок)
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	__ИмяДок__.Ссылка Как Ссылка
		|ИЗ
		|	Документ.__ИмяДок__ КАК __ИмяДок__
		|ГДЕ
		|	__ИмяДок__.Номер = &ЗначениеРеквизита";
		
		
	Запрос.Текст = СтрЗаменить(Запрос.Текст,"__ИмяДок__",ИмяДок);	
	Запрос.УстановитьПараметр("ЗначениеРеквизита", НомерДок);
	
	РезультатЗапроса = Запрос.Выполнить();
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Возврат ВыборкаДетальныеЗаписи.Ссылка;
	КонецЦикла;
	
	Возврат Документы[ИмяДок].ПустаяСсылка();
КонецФункции	


